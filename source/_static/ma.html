<p><HTML>
<HEAD>
<link rel="stylesheet" href="pygments.css"/>
</HEAD>
<BODY></p>
<h1>Pweave Example - Frequency response of a moving average filter</h1>
<p><a href="http://mpastell.com/">Matti Pastell</a></p>
<p>Create 11 point moving average filter and plot its frequency response and print the values.</p>

from pylab import *
import scipy.signal as signal
#A function to plot frequency and phase response
def mfreqz(b,a=1):
    w,h = signal.freqz(b,a)
    h = abs(h)
    return(w/max(w), h)

<p>Make the impulse response function and use terminal formatted output.</p>

n = 11.
n

<div class="highlight"><pre>
11.0
</pre></div>


b = repeat(1/n, n)
b

<div class="highlight"><pre>
array([ 0.09090909,  0.09090909,  0.09090909,  0.09090909,
0.09090909,
        0.09090909,  0.09090909,  0.09090909,  0.09090909,
0.09090909,
        0.09090909])
</pre></div>

<p>Calculate the frequency response and plot it:</p>

w, h = mfreqz(b)
#Plot the function
plot(w,h,'k')
ylabel('Amplitude')
xlabel(r'Normalized Frequency (x$\pi$rad/sample)')
show()
<figure>
<img src="figures/ma_figure3_1.png" width="600"/>
<figcaption >Frequency response of an 11 point moving average filter</figcaption>
</figure>
<p></BODY>
</HTML></p>